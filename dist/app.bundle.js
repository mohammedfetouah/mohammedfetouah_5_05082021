(()=>{class e{constructor(e,t,o,a,n,r){this._id=e,this.price=t,this.name=o,this.imageUrl=a,this.description=n,this.colors=r}getHtml(){return'<a href="produit.html?id='+this._id+'" class="produits"> <div><img class="produit-image" src="'+this.imageUrl+'" alt="nounours"></div><div class="produit-description"><div class="produit-name"><span>'+this.name+'</span></div> <div class="produit-price">  <span> '+this.price/100+"€</span></div></div></a>"}getHtmlProduit(){var e="";for(let t of this.colors)e+='<option value="'+t+'">'+t+"</option>";return'<div class="produit"> <div><img class="produit-image" src="'+this.imageUrl+'" alt="nounours"></div><div class="produit-description"><div class="produit-name"><span>'+this.name+'</span></div> <div class="produit-price">     <span> '+this.description+'</span></div> <div class="produit-price">  <span> '+this.price/100+'€</span></div><select name="colors" id="addColors">'+e+'</select></div><button id="addPanier">  ajouter au panier </button></div>'}}var t=new class{addProduct(e,t,o,a){var n=e+"_"+a.toLowerCase().replace(" ","_");console.log(n);var r=localStorage.getItem("panier");(r=r?JSON.parse(r):{})[n]={name:t,qty:1,color:a,price:o},localStorage.setItem("panier",JSON.stringify(r))}setProductQty(e,t){var o=localStorage.getItem("panier");(o=JSON.parse(o))[e].qty=t,localStorage.setItem("panier",JSON.stringify(o))}getProduits(){var e=localStorage.getItem("panier");return JSON.parse(e)}getTotal(){var e=0;for(let[t,o]of Object.entries(this.getProduits()))e+=o.price*o.qty;return e}getColors(){return localStorage.getItem("colors")}getHtmlQuantity(e,t){for(var o='<select name="quantite" id="'+e+'">',a=1;a<=10;a++)o+=a==t?'<option value="'+a+'" selected>'+a+"</option>":'<option value="'+a+'">'+a+"</option>";return o+"</select>"}},o=new class{addCommande(){var e={};if(e.nom=document.querySelector('#cordonnees input[name="nom"]').value,e.prenom=document.querySelector('#cordonnees input[name="prenom"]').value,e.email=document.querySelector('#cordonnees input[name="email"]').value,e.postal=document.querySelector('#cordonnees input[name="postal"]').value,e.ville=document.querySelector('#cordonnees input[name="ville"] ').value,e.adresse=document.querySelector('#cordonnees input[name="adresse"]').value,"a"!=e.postal){var o=localStorage.getItem("panier");localStorage.setItem("panierCommande",o),localStorage.setItem("totalCommande",t.getTotal()),localStorage.setItem("formulaire",JSON.stringify(e)),localStorage.removeItem("panier"),localStorage.removeItem("panierTotal"),window.location.href="http://localhost:8080/commande.html"}else alert("Le code postal est faux !")}getCommande(){return{panier:JSON.parse(localStorage.getItem("panierCommande")),formulaire:JSON.parse(localStorage.getItem("formulaire")),total:JSON.parse(localStorage.getItem("totalCommande"))}}};if("/"==window.location.pathname&&fetch("http://localhost:3000/api/teddies").then((function(e){if(e.ok)return e.json()})).then((function(t){for(produitData of t){var o=new e(produitData._id,produitData.price,produitData.name,produitData.imageUrl,produitData.description,produitData.colors);document.getElementById("container").innerHTML+=o.getHtml()}})).catch((function(e){})),"/produit.html"==window.location.pathname){var a=window.location.href,n=new URL(a).searchParams.get("id");fetch("http://localhost:3000/api/teddies/"+n).then((function(e){if(e.ok)return e.json();window.location.href="http://localhost:8080/"})).then((function(o){var a=new e(o._id,o.price,o.name,o.imageUrl,o.description,o.colors);document.getElementById("containerProduit").innerHTML+=a.getHtmlProduit(),document.getElementById("addPanier").addEventListener("click",(function(e){var a=document.getElementById("addColors").value;t.addProduct(o._id,o.name,o.price,a)}))})).catch((function(e){}))}if("/panier.html"==window.location.pathname){document.getElementById("clearPanier").addEventListener("click",(function(){localStorage.clear(),window.location.href="http://localhost:8080/panier.html"})),document.getElementById("total").innerHTML="<div><b>Total:</b>"+t.getTotal()/100+"€</div>";var r=document.getElementById("produits");for(let[e,o]of Object.entries(t.getProduits()))r.innerHTML+='<div class="produit"><span>'+o.name+o.color+"</span>"+t.getHtmlQuantity(e,o.qty)+"<span>"+o.price+"€</span></div>";for(let[e,o]of Object.entries(t.getProduits()))document.getElementById(e).addEventListener("change",(function(o){t.setProductQty(e,document.getElementById(e).value),document.getElementById("total").innerHTML="<div><b>Total:</b>"+t.getTotal()/100+"€</div>"}));document.getElementById("cordonnees").addEventListener("submit",(function(e){e.preventDefault(),o.addCommande()}))}"/commande.html"==window.location.pathname&&(document.getElementById("commande"),console.log(o.getCommande()))})();